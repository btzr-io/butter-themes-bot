var api={raw:"https://rawgit.com/",github:"https://api.github.com/",protocol:"butter-themes://",headers:{Accept:"application/vnd.github.mercy-preview+json","User-Agent":"butter-bot/0.1"}},utils={};utils.getJson=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.setRequestHeader("User-Agent",api.headers["User-Agent"]),c.onload=function(){if(c.status>=200&&c.status<400){var a=JSON.parse(c.responseText);b(a)}else console.error("status: "+c.status)},c.onerror=function(a){console.error(a)},c.send()},utils.rawJson=function(a,b){utils.getJson(api.raw+a.user+"/"+a.repository+"/"+(a.branch||"master")+"/"+a.filename,b)},utils.parsePackage=function(a,b){return{name:a.name||b.name,version:a.version||"0.0.0",description:a.description||b.description,author:b.owner.login,official:"butterthemes"===b.owner.login,stats:{stars:b.stargazers_count,forks:b.forks_count},url:{repository:b.html_url,git:b.git_url,css:api.raw+b.name+"/"+b.name+(b.default_branch||"master")+"/index.css",butter:b.html_url.replace("https://",api.protocol)}}};var url=api.github+"search/repositories?q=butter+theme+language:css+fork:false";module.exports=function(a){utils.getJson(url,function(b){var c=[];b.items.map(function(a,b){"butter-theme-"==a.name.substring(0,13)&&c.push(a)});var d=[];c.map(function(b,e){utils.rawJson({user:b.owner.login,repository:b.name,branch:b.default_branch,filename:"package.json"},function(f){var g=utils.parsePackage(f,b);d[e]=g;var h=c.length-1;e===h&&a(d)})})})};
